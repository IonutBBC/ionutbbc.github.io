<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MuzicƒÉ pe Stick - WhatsApp Edition</title>
    <style>
        :root { 
            --primary: #ff0000; 
            --whatsapp: #25D366;
            --dark-bg: #0f0f0f; 
            --text-main: #ffffff; 
            --text-dim: #aaaaaa;
            --accent: #ffcc00;
        }

        body { 
            font-family: 'Segoe UI', sans-serif; 
            background: #000000; 
            margin: 0; 
            display: flex; 
            justify-content: center; 
            min-height: 100vh; 
            color: var(--text-main); 
        }

        .mobile-container { 
            width: 100%; max-width: 500px; 
            background: var(--dark-bg); 
            min-height: 100vh; 
            position: relative; 
            border: 1px solid #333; 
            box-sizing: border-box; 
        }

        .top-steps {
            background: #000;
            color: var(--text-dim);
            padding: 12px;
            font-size: 11px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 5px;
            border-bottom: 2px solid var(--primary);
        }
        .step { display: flex; align-items: center; gap: 5px; }

        .header { padding: 15px; background: var(--dark-bg); }
        .search-bar { display: flex; flex-direction: column; gap: 10px; }
        input { 
            padding: 15px; background: #222; border: 1px solid #444; 
            border-radius: 12px; font-size: 16px; outline: none; color: white;
        }
        .search-btn { 
            padding: 15px; background: var(--primary); color: white; 
            border: none; border-radius: 12px; font-weight: bold; cursor: pointer; 
        }

        /* BUTOANE TOP HITS */
        .top-hits-container {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 8px;
            margin-top: 5px;
        }
        .hit-btn {
            padding: 10px 5px;
            border: 1px solid #444;
            border-radius: 10px;
            background: #1a1a1a;
            color: #eee;
            font-size: 11px;
            font-weight: 600;
            cursor: pointer;
            transition: 0.3s;
            text-align: center;
        }
        .hit-btn:active { transform: scale(0.95); background: #333; }

        #main-banner { 
            width: 100%; 
            height: auto; 
            border-radius: 12px; 
            margin-top: 15px; 
            display: block;
        }

        #results-header {
            padding: 15px 15px 0;
            font-size: 16px;
            color: var(--accent);
            font-weight: bold;
            display: none;
            text-transform: uppercase;
        }

        #results { padding: 10px; }
        .result-item { 
            display: flex; flex-direction: column; gap: 10px; padding: 15px; 
            border-bottom: 1px solid #222; margin-bottom: 10px;
        }
        .result-item img { width: 100%; border-radius: 12px; cursor: pointer; }
        .video-title { color: #fff; font-size: 15px; font-weight: 600; margin-top: 5px; display: block; }

        .btn-group { display: flex; gap: 10px; }
        .play-btn { background: #007bff; color: white; border: none; padding: 12px; border-radius: 8px; flex: 1; cursor: pointer; font-weight: bold; }
        .add-btn { background: #28a745; color: white; border: none; padding: 12px; border-radius: 8px; flex: 1; font-weight: bold; cursor: pointer; }

        #load-more { width: 90%; margin: 20px 5%; padding: 15px; display: none; background: #333; color: white; border: none; border-radius: 12px; }

        /* PLAYER */
        #player-container { 
            display: none; position: fixed; top: 10px; left: 50%; transform: translateX(-50%); 
            width: 90%; max-width: 450px; background: #222; z-index: 3000; 
            padding: 10px; border-radius: 20px; border: 1px solid #444;
        }
        #player-container.active { display: block; }
        iframe { width: 100%; aspect-ratio: 16/9; border-radius: 12px; border: none; }
        .close-player { position: absolute; top: -10px; right: -10px; background: var(--primary); color: white; border: 2px solid white; border-radius: 50%; width: 35px; height: 35px; cursor: pointer; }

        /* PLAYLIST DRAWER */
        #playlist-drawer { 
            position: fixed; top: 0; right: -100%; width: 85%; max-width: 400px; height: 100%; 
            background: #121212; z-index: 4000; box-shadow: -5px 0 15px rgba(0,0,0,0.5); 
            transition: 0.4s ease; display: flex; flex-direction: column; color: white;
        }
        #playlist-drawer.open { right: 0; }
        .drawer-header { padding: 20px; background: #000; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #333; }
        #my-playlist { flex: 1; overflow-y: auto; padding: 15px; list-style: none; margin: 0; }
        .playlist-item { background: #222; padding: 12px; margin-bottom: 10px; border-radius: 8px; display: flex; justify-content: space-between; align-items: center; border-left: 5px solid var(--primary); }
        .delete-btn { color: #ff4444; border: none; background: none; font-weight: bold; cursor: pointer; font-size: 18px; }

        /* FAB */
        .fab-container { position: fixed; bottom: 30px; right: calc(50% - 230px); z-index: 2500; }
        @media (max-width: 500px) { .fab-container { right: 20px; } }
        .fab { width: 65px; height: 65px; background: var(--primary); color: white; border-radius: 50%; display: flex; justify-content: center; align-items: center; box-shadow: 0 4px 15px rgba(0,0,0,0.6); cursor: pointer; font-size: 28px; transition: transform 0.2s; }
        .counter-badge { position: absolute; top: 0; left: 0; background: var(--accent); color: black; font-weight: bold; border-radius: 50%; width: 22px; height: 22px; display: flex; justify-content: center; align-items: center; font-size: 12px; border: 2px solid #000; }
        
        .drawer-footer { padding: 10px; display: flex; flex-direction: column; gap: 10px; background: #000; }
        .send-btn { padding: 15px; background: var(--whatsapp); color: white; border: none; border-radius: 12px; font-weight: bold; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; }
        .clear-btn { padding: 8px; background: transparent; color: #ff4444; border: none; font-size: 12px; cursor: pointer; }

        @keyframes bump { 0% { transform: scale(1); } 50% { transform: scale(1.2); } 100% { transform: scale(1); } }
        .bump-anim { animation: bump 0.3s ease-out; }
    </style>
</head>
<body>

<div class="mobile-container">
    <div class="top-steps">
        <div class="step">üîç CautƒÉ / Topuri</div>
        <div class="step">‚ñ∂ RedƒÉ Video</div>
        <div class="step">‚ûï Pune √Æn ListƒÉ</div>
        <div class="step">üì± WhatsApp</div>
    </div>

    <div id="player-container">
        <button class="close-player" onclick="closePlayer()">√ó</button>
        <div id="player-wrapper"></div>
    </div>

    <div class="header">
        <div class="search-bar">
            <input type="text" id="query" placeholder="Ce melodie vrei?">
            <button class="search-btn" onclick="triggerManualSearch()">CautƒÉ pe YouTube</button>
            
            <div class="top-hits-container">
                <button class="hit-btn" onclick="searchTop('manele noi', 'Top Manele')">üî• Manele Top</button>
                <button class="hit-btn" onclick="searchTop('dance romanesc 2025', 'Dance RO')">üìª Dance Top</button>
                <button class="hit-btn" onclick="searchTop('muzica de petrecere populara', 'Petrecere')">üíÉ Petrecere Top</button>
            </div>

            <img src="img/bannerplaylist.jpg" id="main-banner" alt="Banner Principal">
        </div>
    </div>

    <div id="results-header"></div>
    <div id="results"></div>
    <button id="load-more" onclick="loadMoreResults()">√éncarcƒÉ mai multe...</button>
</div>

<div class="fab-container" onclick="togglePlaylist()">
    <div id="fab-icon" class="fab">üéµ</div>
    <div id="badge" class="counter-badge" style="display:none;">0</div>
</div>

<div id="playlist-drawer">
    <div class="drawer-header">
        <span>Lista mea Stick USB</span>
        <button onclick="togglePlaylist()" style="background:none; border:none; color:white; font-size:30px;">√ó</button>
    </div>
    <ul id="my-playlist"></ul>
    <div class="drawer-footer">
        <button class="clear-btn" onclick="clearFullPlaylist()">üóë Gole»ôte toatƒÉ lista</button>
        <button class="send-btn" onclick="sendToWhatsApp()">Trimite Comanda</button>
    </div>
</div>

<script>
    const API_KEY = 'AIzaSyBHXGyMD9NjuRwH9y8UoqJyNpTSxjo1NHE';
    let nextPageToken = '';
    let songCount = 0;
    let currentActiveQuery = '';
    let isTopSearch = false;

    window.onload = () => {
        const savedData = localStorage.getItem('myPlaylist');
        if (savedData) {
            const list = document.getElementById('my-playlist');
            list.innerHTML = savedData;
            songCount = list.querySelectorAll('li').length;
            updateBadge();
        }
    };

    function triggerManualSearch() {
        const query = document.getElementById('query').value;
        if (!query) return;
        currentActiveQuery = query;
        isTopSearch = false;
        document.getElementById('main-banner').style.display = 'none';
        document.getElementById('results-header').style.display = 'none';
        executeSearch(false);
    }

    function searchTop(keyword, label) {
        currentActiveQuery = keyword;
        isTopSearch = true;
        document.getElementById('main-banner').style.display = 'none';
        const head = document.getElementById('results-header');
        head.innerText = "Afi»ôez: " + label;
        head.style.display = 'block';
        executeSearch(false);
    }

    function loadMoreResults() {
        executeSearch(true);
    }

    async function executeSearch(isMore = false) {
        if (!currentActiveQuery) return;
        
        const date = new Date();
        date.setDate(date.getDate() - 90);
        const publishedAfter = date.toISOString();

        let url = `https://www.googleapis.com/youtube/v3/search?part=snippet&maxResults=15&q=${encodeURIComponent(currentActiveQuery)}&type=video&key=${API_KEY}`;
        
        if (isTopSearch) {
            url += `&order=viewCount&publishedAfter=${publishedAfter}`;
        }
        
        if (isMore && nextPageToken) url += `&pageToken=${nextPageToken}`;

        try {
            const response = await fetch(url);
            const data = await response.json();
            nextPageToken = data.nextPageToken;
            displayResults(data.items, isMore);
            document.getElementById('load-more').style.display = nextPageToken ? 'block' : 'none';
        } catch (e) { alert("Eroare la conexiune."); }
    }

    function displayResults(items, isMore) {
        const resultsDiv = document.getElementById('results');
        if (!isMore) {
            resultsDiv.innerHTML = '';
            window.scrollTo(0,0);
        }
        items.forEach(item => {
            const cleanTitle = item.snippet.title.replace(/"/g, '&quot;').replace(/'/g, '&#39;');
            const videoId = item.id.videoId;
            resultsDiv.innerHTML += `
                <div class="result-item">
                    <img src="${item.snippet.thumbnails.medium.url}" onclick="playVideo('${videoId}')">
                    <span class="video-title">${item.snippet.title}</span>
                    <div class="btn-group">
                        <button class="play-btn" onclick="playVideo('${videoId}')">‚ñ∂ Redare</button>
                        <button class="add-btn" onclick="addToPlaylist('${cleanTitle}')">Ôºã AdaugƒÉ</button>
                    </div>
                </div>`;
        });
    }

    function togglePlaylist() { document.getElementById('playlist-drawer').classList.toggle('open'); }

    function addToPlaylist(title) {
        const list = document.getElementById('my-playlist');
        const li = document.createElement('li');
        li.className = 'playlist-item';
        li.innerHTML = `<span>${title}</span> <button class="delete-btn" onclick="removeFromPlaylist(this)">√ó</button>`;
        list.appendChild(li);
        songCount++;
        updateBadge();
        saveToLocal();
        const fab = document.getElementById('fab-icon');
        fab.classList.add('bump-anim');
        setTimeout(() => fab.classList.remove('bump-anim'), 300);
    }

    function removeFromPlaylist(btn) {
        btn.parentElement.remove();
        songCount--;
        updateBadge();
        saveToLocal();
    }

    function clearFullPlaylist() {
        if (confirm("Gole»ôti toatƒÉ lista?")) {
            document.getElementById('my-playlist').innerHTML = '';
            songCount = 0;
            updateBadge();
            saveToLocal();
        }
    }

    function saveToLocal() {
        localStorage.setItem('myPlaylist', document.getElementById('my-playlist').innerHTML);
    }

    function updateBadge() {
        const b = document.getElementById('badge');
        b.innerText = songCount;
        b.style.display = songCount > 0 ? 'flex' : 'none';
    }

    function playVideo(id) {
        document.getElementById('player-wrapper').innerHTML = `<iframe src="https://www.youtube.com/embed/${id}?autoplay=1" allowfullscreen></iframe>`;
        document.getElementById('player-container').classList.add('active');
    }

    function closePlayer() {
        document.getElementById('player-container').classList.remove('active');
        document.getElementById('player-wrapper').innerHTML = '';
    }

    function sendToWhatsApp() {
        const items = document.querySelectorAll('#my-playlist span');
        if (items.length === 0) return alert("Lista e goalƒÉ!");
        let nume = prompt("Numele tƒÉu:");
        if (!nume) return;
        const numarulMeu = "40751904338"; 
        let textMesaj = `Salut! Sunt ${nume.toUpperCase()} »ôi doresc urmƒÉtoarea muzicƒÉ pe stick:\n\n`;
        items.forEach((it, i) => { textMesaj += `${i + 1}. ${it.innerText}\n`; });
        window.open(`https://api.whatsapp.com/send?phone=${numarulMeu}&text=${encodeURIComponent(textMesaj)}`, '_blank');
    }
</script>
</body>
</html>